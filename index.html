<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>DC project</title>
    <link rel="stylesheet" href="./style.css">

  </head>
    
  <body>
  <!-- AUTH SCREEN (Login / Criar utilizador) -->
<div class="auth" id="authScreen" style="display:none">
  <div class="auth-card">
    <div class="auth-head">
      <div class="logo">DC</div>
      <div>
        <h2 style="margin:0">Gest√£o F√°cil</h2>
        <p class="muted" style="margin:4px 0 0">Entrar para continuar</p>
      </div>
    </div>

    <!-- LOGIN MODE -->
    <div id="authModeLogin">
    <!-- ID DA LOJA / BASE PARTILHADA -->
<div class="field">
  <label>ID da Loja (base partilhada)</label>

  <div class="row gap" style="align-items:center">
    <input class="input" id="workspaceId" placeholder="Ex: DCNET-LOJA1" />
    <button class="btn ghost" id="btnGenWorkspace" type="button">Gerar</button>
  </div>

  <small class="muted">
    Use o <strong>mesmo ID</strong> em todos os dispositivos da mesma loja para partilhar a base.
  </small>
</div>

<div class="row between" style="margin:10px 0 14px">
  <button class="btn ghost" id="btnCompanySetup" type="button">Configurar empresa</button>
  <span class="muted" id="companyHint"></span>
</div>


      <div class="field">
        <label>Utilizador</label>
        <select class="input" id="loginUser"></select>
      </div>

      <div class="field">
        <label>PIN</label>
        <input
          class="input"
          id="loginPin"
          type="password"
          inputmode="numeric"
          placeholder="ex: 1234"
        />
      </div>

      <button class="btn big full" id="btnLogin" type="button">Iniciar sess√£o</button>
      <button class="btn ghost" id="btnForgotPin" type="button">Esqueci PIN</button>

      <div class="row between" style="margin-top:10px">
        <span class="muted" id="loginHint"></span>
        <button class="btn ghost" id="btnGoRegister" type="button">Criar utilizador</button>
      </div>
    </div>

    <!-- REGISTER MODE -->
    <div id="authModeRegister" style="display:none">
      <p class="muted" id="registerTitle" style="margin-top:0"></p>

 <div class="field">
  <label>ID da Loja (base partilhada)</label>
  <input class="input" id="workspaceId" placeholder="Ex: DCNET-LOJA1" />
  <small class="muted">Use o mesmo ID em todos os dispositivos da mesma loja.</small>
</div>
     
     <button class="btn ghost" id="btnGenWorkspace" type="button" style="margin-top:8px">
  Gerar ID automaticamente
</button>

      
      
      <div class="field">
        <label>Nome</label>
        <input class="input" id="regName" placeholder="ex: Admin, Caixa 1" />
      </div>

      <div class="field">
        <label>PIN (4‚Äì8 d√≠gitos)</label>
        <input
          class="input"
          id="regPin"
          type="password"
          inputmode="numeric"
          placeholder="ex: 1234"
        />
      </div>

      <div class="field" id="roleWrap">
        <label>N√≠vel</label>
        <select class="input" id="regRole">
          <option value="admin">Admin</option>
          <option value="manager">Gest√£o</option>
          <option value="staff">Caixa</option>
        </select>
      </div>

      <button class="btn big full" id="btnRegister" type="button">Criar</button>
      <button class="btn ghost full" id="btnBackLogin" type="button" style="margin-top:8px">
        Voltar
      </button>
    </div>
  </div>
</div>

<!-- APP -->
<div class="app" style="display:flex">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">DC</div>
      <div>
        <div class="brand-title">Gest√£o F√°cil</div>
        <div class="brand-sub">Offline + Online</div>
      </div>
    </div>

    <nav class="menu">
      <button class="mitem active" data-page="home">üè† Home</button>
      <button class="mitem" data-page="vendas">üõí Vendas</button>
      <button class="mitem" data-page="compras">üì¶ Compras</button>
      <button class="mitem" data-page="clientes">üë• Clientes</button>
      <button class="mitem" data-page="produtos">üßæ Produtos</button>
      <button class="mitem" data-page="armazem">üè¨ Armaz√©m</button>
      <button class="mitem" data-page="relatorios">üìä Relat√≥rios</button>
      <button class="mitem" data-page="fiscal">üßæ Fiscal</button>
      <button class="mitem" data-page="config">‚öôÔ∏è Config</button>
      <button class="mitem" data-page="suporte">üÜò Suporte</button>
    </nav>

    <div class="sidefoot">
      <div class="pill" id="syncState">Modo: Offline</div>
      <div class="pill subtle" id="deviceState">üì±/üíª Responsivo</div>
    </div>
  </aside>

  <!-- OVERLAY (mobile) -->
  <div class="overlay" id="overlay"></div>

  <!-- MAIN -->
  <main class="main">
    <!-- TOPBAR -->
    <header class="topbar">
      <button class="btn ghost" id="sidebarToggle" type="button" aria-label="Menu">‚ò∞</button>

      <div class="crumb">
        <h1 id="pageTitle">Home</h1>
        <p id="pageDesc">Dashboard geral + contas de pagamento</p>
      </div>

      <div class="top-actions">
        <button class="btn ghost" id="btnSync" type="button">Sincronizar</button>
        <button class="btn" id="btnQuickSale" type="button">+ Venda</button>
      </div>
 <div id="workspaceBadge" class="badge"></div>
      <div class="top-user">
        <span class="pill subtle" id="userBadge">üë§ ‚Äî</span>
        <button class="btn ghost" id="btnLogoutTop" type="button">Sair</button>
      </div>
    </header>

    <!-- HOME -->
    <section class="page active" id="home">
      <div class="grid kpis">
        <div class="card">
          <div class="label">Vendas hoje</div>
          <div class="kpi" id="kpiSalesToday">0.00 MT</div>
          <div class="muted" id="kpiSalesTodayCount">0 vendas</div>
        </div>

        <div class="card">
          <div class="label">Compras hoje</div>
          <div class="kpi" id="kpiBuysToday">0.00 MT</div>
          <div class="muted" id="kpiBuysTodayCount">0 compras</div>
        </div>

        <div class="card">
          <div class="label">Lucro hoje (estim.)</div>
          <div class="kpi" id="kpiProfitToday">0.00 MT</div>
          <div class="muted">Venda - custo (aquisi√ß√£o)</div>
        </div>
      </div>

      <div class="grid two">
        <div class="card">
          <div class="row between">
            <h2>Contas / Formas de pagamento</h2>
            <!-- o script abre modal via bot√µes dentro da lista; este bot√£o √© opcional -->
            <button class="btn" type="button" data-edit-acc="">+ Nova conta</button>
          </div>
          <div id="accountsList" class="list"></div>
        </div>

        <div class="card">
          <div class="row between">
            <h2>Alertas de stock</h2>
            <span class="badge">Stock m√≠nimo</span>
          </div>
          <div id="lowStockList" class="list"></div>
        </div>
      </div>

      <div class="card">
        <div class="row between">
          <h2>√öltimas vendas</h2>
          <button class="btn ghost" data-nav="vendas" type="button">Ver tudo</button>
        </div>
        <div id="lastSales" class="list"></div>
      </div>
    </section>

    <!-- VENDAS -->
    <section class="page" id="vendas">
      <div class="split">
        <div class="card pane">
          <div class="row between">
            <h2>Cat√°logo</h2>
            <input class="input" id="catalogSearch" placeholder="Pesquisar produto..." />
          </div>
          <div id="catalogList" class="catalog"></div>
        </div>

        <div class="card pane">
          <div class="row between">
            <h2>Carrinho</h2>
            <button class="btn danger" id="btnClearCart" type="button">Limpar</button>
          </div>

          <div class="form">
            <div class="field">
              <label>Cliente</label>
              <select class="input" id="saleCustomer"></select>
            </div>

            <div class="field">
              <label>Conta (pagamento)</label>
              <select class="input" id="saleAccount"></select>
            </div>

            <div class="field">
              <label>Data</label>
              <input class="input" type="date" id="saleDate" />
            </div>
          </div>

          <div id="cartList" class="list"></div>

          <div class="totals">
            <div class="row between">
              <span class="muted">Total</span>
              <strong id="cartTotal">0.00 MT</strong>
            </div>

            <button class="btn big" id="btnCheckout" type="button">Finalizar venda</button>
            <small class="muted">Sem desconto nesta vers√£o.</small>
          </div>

          <hr />

          <h3>Vendas (hist√≥rico)</h3>
          <div class="row gap">
            <input class="input" type="date" id="salesFilterDate" />
            <button class="btn ghost" id="btnClearSalesFilter" type="button">Limpar</button>
          </div>
          <div id="salesList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- COMPRAS -->
    <section class="page" id="compras">
      <div class="grid two">
        <div class="card">
          <div class="row between">
            <h2>Registar compra (entra no armaz√©m)</h2>
          </div>

          <form id="buyForm" class="form2">
            <div class="field">
              <label>Fornecedor</label>
              <input class="input" id="buySupplier" placeholder="Nome do fornecedor" required />
            </div>

            <div class="field">
              <label>Produto</label>
              <select class="input" id="buyProduct"></select>
            </div>

            <div class="field">
              <label>Quantidade</label>
              <input class="input" type="number" min="1" step="1" id="buyQty" value="1" required />
            </div>

            <div class="field">
              <label>Pre√ßo de aquisi√ß√£o (unit.)</label>
              <input class="input" type="number" min="0" step="0.01" id="buyCost" required />
            </div>

            <div class="field">
              <label>Conta (pagamento)</label>
              <select class="input" id="buyAccount"></select>
            </div>

            <div class="field">
              <label>Data</label>
              <input class="input" type="date" id="buyDate" />
            </div>

            <button class="btn big full" type="submit">Salvar compra</button>
          </form>
        </div>

        <div class="card">
          <div class="row between">
            <h2>Compras (hist√≥rico)</h2>
            <span class="badge">Entradas de stock</span>
          </div>

          <div class="row gap">
            <input class="input" type="date" id="buysFilterDate" />
            <button class="btn ghost" id="btnClearBuysFilter" type="button">Limpar</button>
          </div>

          <div id="buysList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- CLIENTES -->
    <section class="page" id="clientes">
      <div class="grid two">
        <div class="card">
          <div class="row between">
            <h2>Cadastrar cliente</h2>
          </div>

          <form id="customerForm" class="form2">
            <div class="field">
              <label>Nome</label>
              <input class="input" id="custName" required placeholder="Ex: Maria S." />
            </div>

            <div class="field">
              <label>Telefone/WhatsApp</label>
              <input class="input" id="custPhone" placeholder="84xxxxxxx" />
            </div>

            <div class="field full">
              <label>Notas (opcional)</label>
              <input class="input" id="custNotes" placeholder="Ex: prefere M-Pesa" />
            </div>

            <button class="btn big full" type="submit">Salvar cliente</button>
          </form>
        </div>

        <div class="card">
          <div class="row between">
            <h2>Lista de clientes</h2>
          </div>
          <div id="customersList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- PRODUTOS -->
    <section class="page" id="produtos">
      <div class="grid two">
        <div class="card">
          <div class="row between">
            <h2>Cadastrar produto</h2>
          </div>

          <form id="productForm" class="form2">
            <div class="field">
              <label>Nome</label>
              <input class="input" id="prodName" required placeholder="Ex: Arroz 1kg" />
            </div>

            <div class="field">
              <label>Pre√ßo de venda</label>
              <input class="input" type="number" min="0" step="0.01" id="prodPrice" required />
            </div>

            <div class="field">
              <label>Pre√ßo de aquisi√ß√£o (refer√™ncia)</label>
              <input class="input" type="number" min="0" step="0.01" id="prodCost" required />
            </div>

            <div class="field">
              <label>Stock m√≠nimo</label>
              <input class="input" type="number" min="0" step="1" id="prodMinStock" value="0" required />
            </div>

            <div class="field full">
              <label>Imagem (URL opcional)</label>
              <input class="input" id="prodImg" placeholder="https://..." />
            </div>

            <div class="field full">
              <label>Descri√ß√£o</label>
              <input class="input" id="prodDesc" placeholder="Descri√ß√£o curta" />
            </div>

            <!-- PACOTES -->
            <div class="card inner" style="margin-top:10px">
              <h3 style="margin:0 0 8px">Pacotes / Consumo de Stock</h3>

              <div class="grid two">
                <div class="field full">
                  <label>Este produto consome stock de (opcional)</label>
                  <select class="input" id="prodStockBase">
                    <option value="">‚Äî N√£o (produto normal) ‚Äî</option>
                  </select>
                  <small class="muted">Ex.: selecione ‚ÄúGB (Unidade)‚Äù</small>
                </div>

                <div class="field">
                  <label>Quantidade consumida do stock base</label>
                  <input class="input" id="prodStockFactor" type="number" min="1" step="1" value="1" />
                  <small class="muted">Ex.: 10 (para Pacote 10GB)</small>
                </div>
              </div>
            </div>

            <div class="note full" id="profitNote">Lucro esperado: 0.00 MT</div>
            <button class="btn big full" type="submit">Salvar produto</button>
          </form>
        </div>

        <div class="card">
          <div class="row between">
            <h2>Cat√°logo (produtos)</h2>
            <input class="input" id="productSearch" placeholder="Pesquisar..." />
          </div>
          <div id="productsList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- ARMAZ√âM -->
    <section class="page" id="armazem">
      <div class="card">
        <div class="row between">
          <h2>Armaz√©m (stock em tempo real)</h2>
          <span class="badge">Entradas: compras | Sa√≠das: vendas</span>
        </div>
        <div id="warehouseList" class="list"></div>
      </div>
    </section>

    <!-- RELAT√ìRIOS -->
    <section class="page" id="relatorios">
      <div class="card">
        <div class="row between">
          <h2>Relat√≥rios</h2>
          <span class="badge">V1: base</span>
        </div>
        <p class="muted">A √°rea dos 12 relat√≥rios ser√° criada automaticamente pelo script.</p>
        <!-- (n√£o precisa de mais nada aqui) -->
      </div>
    </section>

    <!-- FISCAL -->
    <section class="page" id="fiscal">
      <div class="card">
        <h2>Fiscal</h2>
        <p class="muted">P√°gina em desenvolvimento.</p>
      </div>
    </section>

    <!-- CONFIG -->
    <section class="page" id="config">
      <div class="card">
        <h2>Config</h2>

        <div class="grid two">
          <div class="card inner">
            <h3>Offline / Backup</h3>

            <div class="row gap">
              <button class="btn ghost" id="btnExport" type="button">Exportar backup (JSON)</button>

              <label class="btn ghost" for="importFile" style="cursor:pointer;">Importar</label>
              <input id="importFile" type="file" accept="application/json" style="display:none;" />
            </div>

            <div class="row gap" style="margin-top:10px;">
              <button class="btn danger" id="btnReset" type="button">Apagar tudo</button>
            </div>
          </div>

          <div class="card inner">
            <h3>Online (Supabase)</h3>
            <p class="muted">Cole aqui as chaves para sincronizar.</p>

            <div class="form2">
              <div class="field full">
                <label>SUPABASE_URL</label>
                <input class="input" id="sbUrl" placeholder="https://xxxx.supabase.co" />
              </div>

              <div class="field full">
                <label>SUPABASE_ANON_KEY</label>
                <input class="input" id="sbKey" placeholder="eyJ..." />
              </div>

              <button class="btn big full" id="btnSaveOnline" type="button">Guardar e ativar online</button>
            </div>

            <!-- o script usa este status -->
            <p class="muted" id="autoBackupStatus" style="margin-top:10px">Auto-backup‚Ä¶</p>

            <div class="grid two" style="margin-top:10px">
              <div class="field">
                <label>Intervalo (minutos)</label>
                <input class="input" id="autoBackupMinutes" type="number" min="5" step="1" />
              </div>

              <div class="field">
                <label>Recupera√ß√£o</label>
                <button class="btn ghost full" id="btnRestoreAutoSnapshot" type="button">
                  Restaurar √∫ltimo snapshot
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- UTILIZADORES (apenas Admin) -->
        <div class="card inner" id="usersCard" style="display:none;">
          <div class="row between">
            <h3>Utilizadores</h3>
          </div>
<button class="btn" id="btnAddUser" type="button">+ Novo utilizador</button>

          <p class="muted" style="margin-top:6px">
            Apenas Admin pode criar/editar utilizadores. Gest√£o/Caixa entram com PIN.
          </p>

          <div id="usersList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- SUPORTE -->
    <section class="page" id="suporte">
      <div class="card">
        <h2>Suporte</h2>

        <div class="grid two">
          <div class="card inner">
            <h3>FAQ</h3>
            <ul class="muted">
              <li>Vendas ‚Üí adicionar no carrinho ‚Üí finalizar.</li>
              <li>Compras ‚Üí salvar compra (entra no armaz√©m).</li>
              <li>Home ‚Üí editar/apagar contas (formas de pagamento).</li>
            </ul>
          </div>

          <div class="card inner">
            <h3>Reportar problema</h3>
            <textarea class="input" id="issueText" rows="5" placeholder="Descreva o problema..."></textarea>
            <button class="btn big" id="btnSendIssue" type="button">Enviar</button>
            <div class="muted" id="issueSent" style="margin-top:10px;"></div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<!-- MODAL (tem que iniciar escondido, sen√£o bloqueia o clique no ecr√£) -->
<div class="modal" id="modal" style="display:none">
  <div class="modal-card">
    <div class="row between">
      <h3 id="modalTitle">Modal</h3>
      <button class="btn ghost" id="modalClose" type="button">Fechar</button>
    </div>
    <div id="modalBody"></div>
  </div>
</div>
    <script  src="./script.js"></script>

  </body>
  
</html>
